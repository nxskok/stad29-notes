
## ------------------------------------------------------------------------
temp=read.csv("temperature.csv")
head(temp)
attach(temp)


## ----tempchunk,eval=F----------------------------------------------------
## plot(temperature~year,type="b")
## lines(lowess(temperature~year))


## ----kahdkjheoiu,echo=F,fig=T--------------------------------------------
plot(temperature~year,type="b")
lines(lowess(temperature~year))


## ------------------------------------------------------------------------
cor.test(temperature,year)


## ------------------------------------------------------------------------
cor.test(temperature,year,method="kendall")


## ------------------------------------------------------------------------
library(Kendall)
MannKendall(temperature)


## ------------------------------------------------------------------------
temp.lm=lm(temperature~year)
summary(temp.lm)$coefficients


## ------------------------------------------------------------------------
library(zyp)
temp.zs=zyp.sen(temperature~year,data=temp)
temp.zs$coefficients


## ------------------------------------------------------------------------
z=zyp.trend.vector(temperature)
z["trend"]
detach(temp)


## ------------------------------------------------------------------------
kings=read.table("kings.txt",header=F)
head(kings)


## ------------------------------------------------------------------------
kings.ts=ts(kings)


## ----fig=T,height=4------------------------------------------------------
plot(kings.ts)
lines(lowess(kings.ts))


## ------------------------------------------------------------------------
kings.diff.ts=diff(kings.ts)


## ----fig=T, height=4.5---------------------------------------------------
plot(kings.diff.ts,main="Kings series, differenced")
lines(lowess(kings.diff.ts))


## ------------------------------------------------------------------------
ny=read.table("nybirths.txt",header=F)
ny.ts=ts(ny,freq=12,start=c(1946,1))


## ------------------------------------------------------------------------
ny.ts


## ----fig=T,height=4.5----------------------------------------------------
plot(ny.ts)


## ----fig=T,height=4------------------------------------------------------
ny.diff.ts=diff(ny.ts)
plot(ny.diff.ts)
lines(lowess(ny.diff.ts))


## ----fig=T,height=4.5----------------------------------------------------
ny.d=decompose(ny.ts)
plot(ny.d)


## ----echo=F--------------------------------------------------------------
set.seed(457299)


## ----fig=T,height=4------------------------------------------------------
wn=rnorm(100)
wn.ts=ts(wn)
plot(wn.ts)


## ------------------------------------------------------------------------
x=rnorm(5)
x.1=c(NA,x)
x.0=c(x,NA)
cbind(x.0,x.1)


## ----fig=T,height=4------------------------------------------------------
wn.1=c(NA,wn)
wn.0=c(wn,NA)
plot(wn.1,wn.0)
cor(wn.1,wn.0,use="c")


## ------------------------------------------------------------------------
kings.1=c(NA,kings.ts)
kings.0=c(kings.ts,NA)
cor(kings.1,kings.0,use="c")


## ----fig=T,height=4.5----------------------------------------------------
plot(kings.1,kings.0)


## ------------------------------------------------------------------------
# one step back
cor(kings.1,kings.0,use="c")
# one step plus one more
kings.2=c(NA,kings.1)
kings.0=c(kings.0,NA)
cor(kings.0,kings.2,use="c")


## ----fig=T,height=4------------------------------------------------------
acf(wn.ts)


## ----fig=T,height=4.5----------------------------------------------------
acf(kings.diff.ts)


## ----fig=T,height=4.5----------------------------------------------------
acf(ny.diff.ts,main="NY births differenced")


## ------------------------------------------------------------------------
souv=read.table("souvenir.txt",header=F)
souv.ts=ts(souv,frequency=12,start=1987)


## ------------------------------------------------------------------------
souv.ts


## ----fig=T---------------------------------------------------------------
plot(souv.ts)


## ----fig=T,height=4.5----------------------------------------------------
souv.log.ts=log(souv.ts)
plot(souv.log.ts)


## ----fig=T,height=4.5----------------------------------------------------
souv.log.diff.ts=diff(souv.log.ts)
plot(souv.log.diff.ts)


## ----fig=T,height=4.5----------------------------------------------------
souv.d=decompose(souv.log.diff.ts)
plot(souv.d)


## ----echo=F--------------------------------------------------------------
options(width=60)


## ------------------------------------------------------------------------
round(souv.d$seasonal,2)


## ----fig=T,height=4.5----------------------------------------------------
acf(souv.log.diff.ts)


## ------------------------------------------------------------------------
e=rnorm(100)
y=numeric(0)
y[1]=0
beta=1
for (i in 2:100)
{
  y[i]=e[i]+beta*e[i-1]
}
y


## ----fig=T,height=4.5----------------------------------------------------
acf(y)


## ------------------------------------------------------------------------
e=rnorm(100)
x=numeric(0)
x[1]=0
alpha=0.7
for (i in 2:100)
{
  x[i]=alpha*x[i-1]+e[i]
}
x


## ----fig=T---------------------------------------------------------------
acf(x)


## ----fig=T,height=4.5----------------------------------------------------
pacf(x)


## ----fig=T,height=4.5----------------------------------------------------
pacf(y)


## ----fig=T,height=4.5----------------------------------------------------
acf(y)


## ------------------------------------------------------------------------
library(forecast)
auto.arima(y)


## ------------------------------------------------------------------------
auto.arima(y,trace=T)


## ------------------------------------------------------------------------
wn.aa=auto.arima(wn.ts)
wn.aa


## ------------------------------------------------------------------------
forecast(wn.aa)


## ------------------------------------------------------------------------
y.aa=auto.arima(y)
y.aa
y.f=forecast(y.aa)


## ----fig=T,height=4.5----------------------------------------------------
plot(y.f)


## ------------------------------------------------------------------------
x.aa=auto.arima(x)
x.aa


## ------------------------------------------------------------------------
x.arima=arima(x,order=c(1,0,0))
x.arima


## ----fig=T---------------------------------------------------------------
plot(forecast(x.arima))


## ----fig=T---------------------------------------------------------------
plot(forecast(x.aa))


## ------------------------------------------------------------------------
kings.aa=auto.arima(kings.ts)
kings.aa


## ------------------------------------------------------------------------
kings.f=forecast(kings.aa)
kings.f


## ----fig=T---------------------------------------------------------------
plot(kings.f)


## ------------------------------------------------------------------------
ny.aa=auto.arima(ny.ts)
ny.aa
ny.f=forecast(ny.aa,h=36)


## ------------------------------------------------------------------------
ny.f$mean


## ----fig=T---------------------------------------------------------------
plot(ny.f)


## ----cache=T-------------------------------------------------------------
souv.aa=auto.arima(souv.log.ts)
souv.aa
souv.f=forecast(souv.aa,h=27)


## ------------------------------------------------------------------------
exp(souv.f$mean)


## ----fig=T---------------------------------------------------------------
plot(souv.f)


## ------------------------------------------------------------------------
attach(temp)
temp.ts=ts(temperature,start=1880)
temp.aa=auto.arima(temp.ts)
temp.aa


## ----fig=T,height=4.5----------------------------------------------------
temp.f=forecast(temp.aa)
plot(temp.f)


